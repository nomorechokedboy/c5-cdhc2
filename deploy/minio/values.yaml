## MinIO Helm Chart Values
## Official MinIO Chart Configuration

## MinIO mode - standalone or distributed
mode: standalone  # Change to 'distributed' for production

## Number of MinIO pods (only for distributed mode)
## For distributed mode, must be 4, 8, 12, or 16
replicas: 4

## MinIO root credentials
rootUser: admin.cdhc2
rootPassword: Cntt@Hc2*#s3  # CHANGE THIS!

## Persistence configuration
persistence:
  enabled: true
  storageClass: "hdd-storage"
  accessMode: ReadWriteOnce
  size: 5Ti

## Resource limits
resources:
  requests:
    memory: 512Mi
    cpu: 250m
  limits:
    memory: 2Gi
    cpu: 1000m

## Service configuration
service:
  type: ClusterIP  # Change to LoadBalancer or NodePort if needed
  port: 9000
  consolePort: 9001

## Ingress configuration
ingress:
  enabled: true
  ingressClassName: nginx  # Change to your ingress class
  annotations:
    cert-manager.io/cluster-issuer: letsencrypt-prod  # If using cert-manager
    nginx.ingress.kubernetes.io/proxy-body-size: "0"
    nginx.ingress.kubernetes.io/proxy-request-buffering: "off"
  hosts:
    - s3.hc2  # CHANGE THIS to your domain

## Console ingress (MinIO Web UI)
consoleIngress:
  enabled: true
  ingressClassName: nginx
  annotations:
    cert-manager.io/cluster-issuer: letsencrypt-prod
  hosts:
    - s3-console.hc2  # CHANGE THIS to your domain

## Security Context
securityContext:
  enabled: true
  runAsUser: 1000
  runAsGroup: 1000
  fsGroup: 1000

## Pod Security Context
podSecurityContext:
  enabled: true
  fsGroup: 1000

## Environment variables
environment:
  ## MinIO Browser settings
  MINIO_BROWSER: "on"
  
  ## MinIO Region (for S3 compatibility)
  MINIO_REGION: "us-east-1"
  
  ## MinIO Domain (optional, for virtual-host-style requests)
  MINIO_DOMAIN: "s3.hc2"
  MINIO_BROWSER_REDIRECT_URL: "https://s3-console.hc2"

## Buckets to create automatically
buckets:
  - name: moodle-objectfs
    policy: none
    purge: false
  - name: backups
    policy: none
    purge: false
  - name: media
    policy: download  # public read access
    purge: false

## Users to create (beyond root)
users:
  - accessKey: cdhc2-s3
    secretKey: cdhc2#*s3@Cntt
    policy: readwrite

## Policies
policies:
  - name: moodle-policy
    statements:
      - resources:
          - 'arn:aws:s3:::moodle-objectfs/*'
        actions:
          - "s3:GetObject"
          - "s3:PutObject"
          - "s3:DeleteObject"
          - "s3:ListBucket"

## Node Affinity (optional)
affinity: {}

## Node Selector (optional)
nodeSelector: {}

## Tolerations (optional)
tolerations: []

## Pod annotations
podAnnotations: {}

## Pod labels
podLabels: {}

## Liveness probe
livenessProbe:
  httpGet:
    path: /minio/health/live
    port: 9000
  initialDelaySeconds: 30
  periodSeconds: 10
  timeoutSeconds: 5
  successThreshold: 1
  failureThreshold: 3

## Readiness probe
readinessProbe:
  httpGet:
    path: /minio/health/ready
    port: 9000
  initialDelaySeconds: 15
  periodSeconds: 10
  timeoutSeconds: 5
  successThreshold: 1
  failureThreshold: 3

## Network Policy
networkPolicy:
  enabled: false
  allowExternal: true

## PodDisruptionBudget
podDisruptionBudget:
  enabled: false
  maxUnavailable: 1

## Metrics configuration (Prometheus)
metrics:
  serviceMonitor:
    enabled: true
    namespace: monitoring
    interval: 30s
    scrapeTimeout: 10s
